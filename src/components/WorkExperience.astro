---
import Badge from "@/components/ui/badge.astro";
import Card from "@/components/ui/card.astro";
import CardHeader from "@/components/ui/card-header.astro";
import CardContent from "@/components/ui/card-content.astro";
import Section from "@/components/ui/section.astro";
import { RESUME_DATA } from "@/data/resume-data";
import { cn } from "@/lib/utils";

type WorkExperience = (typeof RESUME_DATA)["work"][number];

interface Props {
  work: (typeof RESUME_DATA)["work"];
}

const { work } = Astro.props;
---

<Section>
  <h2 class="text-2xl text-blue-900 font-bold" id="work-experience">
    Work Experience
  </h2>
  <div
    class="space-y-4 print:space-y-0"
    role="feed"
    aria-labelledby="work-experience"
  >
    {
      work.map((item) => (
        <article role="article">
          <Card className="py-1 print:py-0">
            <CardHeader className="print:space-y-1">
              <div class="flex items-center justify-between text-base">
                <h3 class="inline-flex text-xl items-center justify-center gap-x-1 font-semibold leading-none print:text-sm">
                  <a
                    class="hover:underline"
                    href={item.link}
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label={`${item.company} company website`}
                  >
                    {item.company}
                  </a>
                </h3>
                <div>
                  {item.badges.length > 0 && (
                    <ul
                      class={cn("hidden gap-x-1 sm:inline-flex list-none p-0")}
                      aria-label="Technologies used"
                    >
                      {item.badges.map((badge) => (
                        <li>
                          <Badge
                            variant="secondary"
                            className="align-middle text-xs print:px-1 print:py-0.5 print:text-[8px] print:leading-tight"
                          >
                            {badge}
                          </Badge>
                        </li>
                      ))}
                    </ul>
                  )}
                </div>
              </div>

              <h4 class="mb-0 font-mono text-sm font-semibold print:text-[12px]">
                {item.title}
              </h4>

              <div
                class="text-sm tabular-nums text-gray-500 mb-2"
                aria-label={`Employment period: ${item.start} to ${item.end ?? "Present"}`}
              >
                {item.start} - {item.end ?? "Present"}
              </div>
            </CardHeader>

            <CardContent>
              <div
                class="mt-2 print:mt-1 print:text-[10px] text-pretty leading-6"
                set:html={item.description}
              />
              {item.badges.length > 0 && (
                <div class="mt-2">
                  <ul
                    class={cn(
                      "-mx-2 flex-wrap gap-1 sm:hidden inline-flex list-none p-0"
                    )}
                    aria-label="Technologies used"
                  >
                    {item.badges.map((badge) => (
                      <li>
                        <Badge
                          variant="secondary"
                          className="align-middle text-xs print:px-1 print:py-0.5 print:text-[8px] print:leading-tight"
                        >
                          {badge}
                        </Badge>
                      </li>
                    ))}
                  </ul>
                </div>
              )}
            </CardContent>
          </Card>
        </article>
      ))
    }
  </div>
</Section>
